<html>

<head>
</head>

<body>
    <div id="app">
        <input type="text" name="name"><br>
        <input type="range" name="age"><br>
        <input type="text" name="doubleAge"><br>
        <input type="checkbox" name="actor"><br>
        <div>
            <textarea name="address.country"></textarea>
        </div>
        <input type="text" name="email"><br>
        <select name="gender">
            <option value="male">Male</option>
            <option value="female">Female</option>
        </select>
        <p> {{ name }} </p>
        <p> {{ age }}</p>
        <p> {{ doubleAge }}</p>
        <p> {{ address.country }} </p>
        <p> {{ email }} </p>
        <p> {{ gender }} </p>
    </div>
    <script src="../src/rudy.js"></script>
    <script>

        'use strict';

        // let's start timing, just for fun
        console.time('Timer');

        // this is a utility function to make an AJAX request. it's not part of Rudy. we'll use it down below to bind the view to a server response
        function get(url, callback) {
            var request = new XMLHttpRequest();
            request.open('GET', url, true);
            request.onload = function () {
                if (request.readyState != 4 || request.status != 200) callback(true);
                else callback(null, JSON.parse(request.responseText));
            }; 
            try {
                request.send();
            }
            catch (error) {}
        }

        // hang on to the returned object! you can do stuff with it later
        var person = rudy(

            // specify the tag id where you want to render your component
            'app',

            // the component behaviour is fed as object properties
            {

                // enter your initial data
                data : {
                    name: 'John',
                    age: 30,
                    address: {
                        country: 'Canada'
                    },
                    actor: true,

                    // your data can be functions! this function is called everytime
                    // new data is bound to the view, including the initialization.
                    // all values passed to `this` are read-only and changing them 
                    // will not affect the view nor model

                    // you can calculate data on every model/view update!
                    doubleAge: function() {
                        
                        // you can access the rest of the model in here!
                        // the `this` variable will give you a locally scoped copy of the model
                        console.log('I\'m calling you from *inside* the function', this.age);

                        // remember, you only have a local copy of the model
                        // you can alter it, but it will not have an affect outside of this function
                        // and it will not update the view
                        this.age = 1;

                        // return a value to pass it to the model (should be: 2)
                        return this.age * 2;
                    }
                },

                // this function is called once before the first render
                create: function() {
                    console.log('CREATE PERSON', this)
                    var vm = this;

                    vm.name = 'James';
                    vm.age = 25;
                    vm.actor = false;
                    
                    // asynchronous binding updates allowed!
                    get(
                        'https://jsonplaceholder.typicode.com/comments/1',
                        function(error, body) {
                            
                            // notice that email wasn't originally a property of the data object
                            if (body) vm.email = body.email;
                        }
                    );
                }
            }
        );

        // you don't need to be inside your component object to update the data. let's change an existing value
        person.data.name='Micheal';

        // go ahead, overwrite the whole data object
        person.data = {
            name: 'Bonita',
            age: 55,
            doubleAge: function() {
                return this.age / 2;
            }
        };

        // let's add back some values we wiped away
        person.data.address = {country: 'Colombia'};
        person.data.address.country = 'Mexico';
        person.data.actor = true;

        // and one more brand new variable
        person.data.gender = 'female';
        

        // it's pretty fast!
        console.timeEnd('Timer');
        
    </script>
</body>

</html>