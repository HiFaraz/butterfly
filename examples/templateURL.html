<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Rudy | Fast, simple, flexible front-end components</title>
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w="
        crossorigin="anonymous" />-->
    <link rel="stylesheet" href="https://bootswatch.com/cosmo/bootstrap.min.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="/styles/app.css" />
</head>

<body>
    <div id="top" class="container">
        <nav class="navbar navbar-default" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2"
                        aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Rudy</a>
                </div>
                <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-2" aria-expanded="false" style="height: 0.8px;">
                    <ul class="nav navbar-nav">
                        <li><a href="#get-started">Get started</a></li>
                        <li><a href="#simple-and-flexible">Simple and flexible</a></li>
                        <li><a href="#demo">Demo</a></li>
                        <li><a href="#demo-source-code">Demo source code</a></li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="https://github.com/HiFaraz/rudy">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="jumbotron" style="margin-top: 2rem;">
            <h1>Render your view in under 11ms* for 2.2kb</h1>
            <p>Make simple, flexible, re-usable, social front-end components with Rudy</p>
            <small>* average render time</small>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1 id="typography">Rudy is an experimental front-end component library and a personal project</h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8" style="border-right: 1px solid #ccc">
                <h2 id="get-started">Get started in 10 seconds</h2>
                <strong>Define your template:</strong>
                <pre>&lt;div id="app"&gt; {{ firstName }} &lt;input type="text" name="firstName"&gt; &lt;/div&gt;</pre>
                <strong>Define your component:</strong>
                <pre>var person = rudy( { target: '#app', data: { firstName: 'Micheal'} } );</pre>
                <strong>Mix things up:</strong>
                <pre>person.data.firstName = 'George';</pre>
                <p><small><a href="#top">(back to top)</a></small></p>
            </div>
            <div class="col-md-4">
                <h2>Status</h2>
                <p>Rudy is in pre-release state. It weighs ~ 2.2kb minified and gzipped.</p>
                <p>Rudy relies on ECMAScript 2015 Proxy objects. A limited functionality polyfill is available <a href="https://github.com/GoogleChrome/proxy-polyfill">here</a>.</p>
                <p>There is a fully working demo below, and the demo source code is included in the bottom of the document.</p>
                <p>The views below are dynamically generated. The view internals are not in the source HTML document.</p>
                <p>Released under the MIT licence by <a href="https://github.com/HiFaraz">Faraz Syed</a>.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2 id="simple-and-flexible">Simple and flexible</h2>
                <p>Rudy began with a question: can you balance simplicity <em>and</em> flexibility in front-end components?
                    I made up a list of wants and to-avoids:</p>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="col-sm-2">Task</th>
                            <th class="col-sm-5">Want</th>
                            <th class="col-sm-5">Avoid</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>View model updates</td>
                            <td>
                                <p>Write directly to a data object:</p>
                                <p><code>component.data.property = newValue;</code></p>
                            </td>
                            <td>
                                <ul>
                                    <li>
                                        <p>Setting functions:</p>
                                        <p><code>component.set('property', newValue);</code></p>
                                    </li>
                                    <li>
                                        <p>Digest cycles / dirty checking clogging the CPU:</p>
                                        <p><code>$scope.apply(function(){ $scope.property = newValue });</code></p>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td>Data-binding</td>
                            <td>
                                <p><strong>One-way binding by default</strong></p>
                                <p>Bind the value of the textbox to the variable
                                    <code>address.city</code> through the <code>name</code> attribute. However typing in
                                    the textbox will not update the data model.</p>
                                <p><code>&lt;input type="text" name="address.city"&gt;</code></p>
                                <p><strong>Two-way binding on a specific element</strong></p>
                                <p>
                                    Add two-way binding to the textbox from above through a
                                    <code>bind</code> attribute.
                                </p>
                                <p><code>&lt;input type="text" name="address.city" bind&gt;</code></p>
                                <p><strong>Two-way binding on a specific data model</strong></p>
                                <p>
                                    Add two-way binding only to <code>address.city</code> through the component configuration:
                                </p>
                                <p><code>watchers: { 'address.city' : true }</code></p>
                                <p><strong>Two-way binding on the entire data model</strong></p>
                                <p>
                                    Add two-way binding to the entire data model through the component configuration:
                                </p>
                                <p><code>watchers: true</code></p>
                                <p>
                                    In this case, you can remove two-way binding to a specific form element through an
                                    <code>no-bind</code> attribute.
                                </p>
                                <p><code>&lt;input type="text" name="address.city" no-bind&gt;</code></p>
                            </td>
                            <td>
                                <ul>
                                    <li>
                                        <p>One-way binding only:</p>
                                        <p><code>&lt;input type="text" value={address.city}&gt;</code> (React)</p>
                                    </li>
                                    <li>
                                        <p>Two-way binding only:</p>
                                        <p><code>&lt;input type="text" ng-model="address.city"&gt;</code> (AngularJS)</p>
                                        <p><code>&lt;input type="text" v-model="address.city"&gt;</code> (Vue.js)</p>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td>Rendering DOM updates</td>
                            <td>
                                <p>Touch only the DOM elements mapped to the data model. This happens in the Rudy internals.
                                    It creates a map when you first load the component.</p>
                            </td>
                            <td>
                                <p>Re-writing the entire DOM on a data model update:</p>
                                <p><code>component.target.innerHTML = '...'</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td>Constructors and watchers</td>
                            <td>
                                <p>Call a function at the beginning of the component lifecycle by attaching it to the component:</p>
                                <p><code>create: function() { }</code></p>
                                <p>Call a function whenever the data model is updated or there is input on a watched form element:</p>
                                <p><code>watchers: { 'address.city' : function(value, element) { } }</code></p>
                            </td>
                            <td>
                                not applicable
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p><small><a href="#top">(back to top)</a></small></p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1 id="demo">Demo</h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-7">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Model views</h3>
                    </div>
                    <div id="app" class="panel-body">
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <div class="panel panel-success ">
                    <div class="panel-heading">
                        <h3 class="panel-title">Markdown preview of <code>address.country</code></h3>
                    </div>
                    <div id="preview" class="panel-body"></div>
                </div>
            </div>
        </div>
        <p><small><a href="#top">(back to top)</a></small></p>
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1 id="demo-source-code">Source code for demo</h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div id="codeView"></div>
                <p><small><a href="#top">(back to top)</a></small></p>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/marked@0.3.6"></script>
    <script src="/js/rudy.js"></script>
    <script id="code">
'use strict';

// let's go! all you have to do is send an object to rudy.
// hang on to the returned object btw, you can do stuff with it later
var person = rudy(

    // the component behaviour is fed as object properties
    {

        // specify the tag id where you want to render your component
        target: '#app',

        // enter your initial data
        data : {
            name: 'John',
            age: 30,
            address: {
                country: 'Canada'
            },
            actor: true,

            // your data can be functions! this function is called everytime
            // new data is bound to the view, including the initialization.
            // all values passed to `this` are read-only and changing them 
            // will not affect the view nor model

            // you can calculate data on every model/view update!
            ageFn: function() {
                
                // you can access the rest of the model in here!
                // the `this` variable will give you a locally scoped copy of the model
                // console.log('I\'m calling you from *inside* the function', this.age);

                // remember, you only have a local copy of the model
                // you can alter it, but it will not have an affect outside of this function
                // and it will not update the view
                this.age = 1;

                // return a value to pass it to the model (should be: 2)
                return this.age * 2;
            }
        },

        // create some watchers! get notified by input events and model updates
        // to enable two-way binding on all variables, set `watchers: true`
        // instead of passing it an object
        watchers: {

            // setting to `true` tells Rudy to enable two-way data-binding on all form elements
            actor: true,

            // this function does not return anything to the form element. Instead it does another
            // operation entirely. It reflects a Markdown preview in another <div> tag
            address: {
                country: function(value, element) {
                    document.getElementById('preview').innerHTML = marked(value, { sanitize: true });

                    // instead of omitting the return statement, you can also explicitly return a falsy value
                    // for example: `return false;` or `return null;` - these will not cause the form element
                    // to update
                    
                }
            },

            age: true,

            // watcher functions run BEFORE any data calculations or bindings happen (interception)
            // you can use this to intercept asynchronous requests
            email: function(value, element) {
                
                // whatever you return from here will be set in the model and view 
                return value.toLowerCase();
            },

            // let's force all name to be UPPERCASE 
            name: function(value, element) {
                return value.toUpperCase();
            }
        },

        // this function is called once before the first render
        create: function() {
            var vm = this;

            vm.name = 'James';
            vm.age = 25;
            vm.actor = false;
            
            // asynchronous binding updates allowed! we define this function way down below
            getResource('https://jsonplaceholder.typicode.com/comments/1')
                .then(function(body) {

                    // notice that email wasn't originally a property of the data object
                    vm.email = body.email;
                });
        },

        // you can load a template from a file! the order of precedence is:
        // templateURL > template > whatever is already in the target element
        // templateURL: '/partials/app.html'
        templateURL: 'app.html'
        
        
    }
);

// you don't need to be inside your component object to update the data. let's change an existing value
person.data.name = 'Micheal';

// go ahead, overwrite the whole data object
person.data = {
    name: 'Maria',
    age: 55,
    ageFn: function() {
        return this.age / 2;
    }
};

// let's add back some values we wiped away
person.data.address = {country: 'Colombia'};
person.data.address.country = '# Mexico\n* A land of wonder';
person.data.actor = true;

// and one more brand new variable
person.data.gender = 'female';

// this is a utility function to make an AJAX request. it's not part of Rudy. we'll use it down below to bind the view to a server response
function getResource(url, callback) {

    return new Promise(function(resolve,reject) {

        var request = new XMLHttpRequest();
        request.open('GET', url, true);
        request.onload = function () {
            if (request.readyState != 4 || request.status != 200) reject();
            else resolve(JSON.parse(request.responseText));
        }; 
        try {
            request.send();
        }
        catch (error) {
            reject(error);
        }

    });

}

// generate the code preview
document.getElementById('codeView').innerHTML = marked('```javascript\n'+document.getElementById('code').innerHTML+'\n```').trim();

    </script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
</body>

</html>